var MainRouter=Backbone.Router.extend({routes:{"items/:id":"itemView"},initialize:function(){console.log("the router is born")},listView:function(){new ListView},itemView:function(a){if(a&&etsyItems){var b=etsyItems.find(function(b){return b.get("listing_id")==a});console.log("switched to viewing item number",a,"model       ",b),new ItemView(b)}}}),EtsyItem=Backbone.Model.extend({}),EtsyItemsCollection=Backbone.Collection.extend({model:EtsyItem,url:"http://tiny-pizza-server.herokuapp.com/collections/EtsyItemCollection"}),ItemView=Backbone.View.extend({className:"item-view panel panel-default",initialize:function(){this.render(),$(".item-viewer").html(this.el)},renderTemplate:_.template($("#item-view-template").text()),render:function(){this.$el.html(this.renderTemplate(this.model))}}),ListView=Backbone.View.extend({tagName:"a",className:"list-view list-group-item clearfix",initialize:function(a){this.setHref(a),this.render(),$(".list-viewer").append(this.el)},renderTemplate:_.template($("#list-view-template").text()),render:function(){this.$el.html(this.renderTemplate(this.model))},setHref:function(a){var b=a.get("listing_id"),c="#/items/"+b;this.$el.attr({href:c})}});console.log("'Allo 'Allo!"),router=new MainRouter,$.ajax({dataType:"jsonp",url:"https://openapi.etsy.com/v2/listings/active.js?callback=etsyResults&fields=title,price,description,listing_id,url&includes=Images&api_key=kr9rjq7dc9c24jv6fccq2hus",data:"",success:function(a){etsyItems=new EtsyItemsCollection(a.results),etsyItems.each(function(a){new ListView(a)}),Backbone.history.start()},error:function(a){console.log("error",a.statusText)}});